\documentclass[letterpaper,twocolumn,openany,nodeprecatedcode]{dndbook}

% Use babel or polyglossia to automatically redefine macros for terms
% Armor Class, Level, etc...
% Default output is in English; captions are located in lib/dndstrings.sty.
% If no captions exist for a language, English will be used.
%1. To load a language with babel:
%	\usepackage[<lang>]{babel}
%2. To load a language with polyglossia:
%	\usepackage{polyglossia}
%	\setdefaultlanguage{<lang>}
\usepackage[english]{babel}
%\usepackage[italian]{babel}
% For further options (multilanguage documents, hypenations, language environments...)
% please refer to babel/polyglossia's documentation.

\usepackage[utf8]{inputenc}
\usepackage[singlelinecheck=false]{caption}
\usepackage{lipsum}
\usepackage{listings}
\usepackage{shortvrb}
\usepackage{stfloats}
\usepackage{xtab}
\usetikzlibrary{intersections}

\captionsetup[table]{labelformat=empty,font={sf,sc,bf,},skip=0pt}

% Uncomment to allow the default background paper image to be overridden.
%\SetPaperImage{img/paper}

\MakeShortVerb{|}

\lstset{%
  basicstyle=\ttfamily,
  language=[LaTeX]{TeX},
  breaklines=true,
}

\title{The Dark \LaTeX{} \\
\large An Example of the dndbook Class}
\author{The rpgTeX Team}
\date{2020/04/21}

%%%%%%%%%%%%% START "dndlongtable" CODE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Normally, @ is not a valid character in macro names. Make the @ symbol a
% normal letter in order to call an internal command from the dnd package.
% See <https://tex.stackexchange.com/a/8353> for more information.
\makeatletter
\NewDocumentEnvironment{dndlongtable}{O{>{\centering}p{0.2\linewidth} p{0.7\linewidth}} O{tablecolor}}{%
  % End horizontal mode. Pad the top of the table with some vertical space.
  \par\vspace*{8pt}
  % Disable indentation on the next line.
  \noindent
  % Set the sans-serif table body font.
  \DndFontTableBody
  % Set alternating row colours.
  \rowcolors{1}{}{#2}
  % Create an `xtabular*` table as wide as the current line (column) and pass
  % the column spec to it (#1).
  \begin{xtabular*}{\linewidth}{#1}
}{%
  \end{xtabular*}
  % Pad the bottom of the table with some vertical space.
  \vspace{8pt plus 1pt}
  % Disable indentation on the next line.
  \noindent
}
% Disable the @ character in macro names again.
\makeatother
%%%%%%%%%%%%% END "dndlongtable" CODE %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\frontmatter

\maketitle

\tableofcontents

\mainmatter%

\part{Layout}

\chapter{Sections}

\DndDropCapLine{T}{his package is designed to aid you in} writing beautifully typeset documents for the fifth edition of the world's greatest roleplaying game. It starts by adjusting the section formatting from the defaults in \LaTeX{} to something a bit more familiar to the reader. The chapter formatting is displayed above.

\section{Tables}
The |DndTable| colors the even rows and is set to the width of a line by default.

\begin{DndTable}[header=Nice Table]{XX}
    \textbf{Table head}  & \textbf{Table head} \\
    Some value  & Some value \\
    Some value  & Some value \\
    Some value  & Some value
\end{DndTable}

\section{Table Options}
Examples of different table types that can be added when needed.

\subparagraph{Note} These examples are currently in a separate file
(|table-examples.tex|) because some of the code only works
when embedded in the |.tex| file. They'll be moved if/when that code
can be cleaned up.

\subsection{Alternate Table Background}

The |DndAltTable| allows tables that have a blank "header" line followed
by alternating theme color and white background, as per some of the sourcebooks.

\begin{DndAltTable}{cX}
    \textbf{Table head} & \textbf{Table head} \\
    Some value  & Some value \\
    Some value  & Some value \\
    Some value  & Some value \\
    Some value  & Some value \\
\end{DndAltTable}

\subsection{Long Table that Spans Pages}

The |dndlongtable| allows table that can span multiple pages. The current
version is configured to do a two-column table.

\begin{dndlongtable}
    \textbf{Roll (d100)} & \textbf{Result} \\
    1-2 & You win a magic item or an expensive piece of classic artwork. \\
    3-4 & You win a magic item or an expensive piece of classic artwork. \\
    5-6 & You win a magic item or an expensive piece of classic artwork. \\
    7-8 & You win a magic item or an expensive piece of classic artwork. \\
    9-10 & You win a magic item or an expensive piece of classic artwork. \\
    11-12 & You win a magic item or an expensive piece of classic artwork. \\
    13-14 & You win a magic item or an expensive piece of classic artwork. \\
    15-16 & You win a magic item or an expensive piece of classic artwork. \\
    17-18 & You win a magic item or an expensive piece of classic artwork. \\
    19-20 & You win a magic item or an expensive piece of classic artwork. \\
    20-22 & You win a magic item or an expensive piece of classic artwork. \\
    23-24 & You win a magic item or an expensive piece of classic artwork. \\
    25-26 & You win a magic item or an expensive piece of classic artwork. \\
    27-28 & You win a magic item or an expensive piece of classic artwork. \\
    29-30 & You win a magic item or an expensive piece of classic artwork. \\
    31-32 & You win a magic item or an expensive piece of classic artwork. \\
    33-34 & You win a magic item or an expensive piece of classic artwork. \\
    35-36 & You win a magic item or an expensive piece of classic artwork. \\
    37-38 & You win a magic item or an expensive piece of classic artwork. \\
    39-40 & You win a magic item or an expensive piece of classic artwork. \\
    41-42 & You win a magic item or an expensive piece of classic artwork. \\
    43-44 & You win a magic item or an expensive piece of classic artwork. \\
    45-46 & You win a magic item or an expensive piece of classic artwork. \\
    47-48 & You win a magic item or an expensive piece of classic artwork. \\
    49-50 & You win a magic item or an expensive piece of classic artwork. \\
    51-52 & You win a magic item or an expensive piece of classic artwork. \\
    53-54 & You win a magic item or an expensive piece of classic artwork. \\
    55-56 & You win a magic item or an expensive piece of classic artwork. \\
    57-58 & You win a magic item or an expensive piece of classic artwork. \\
    59-60 & You win a magic item or an expensive piece of classic artwork. \\
    61-62 & You win a magic item or an expensive piece of classic artwork. \\
    63-64 & You win a magic item or an expensive piece of classic artwork. \\
    65-66 & You win a magic item or an expensive piece of classic artwork. \\
    67-68 & You win a magic item or an expensive piece of classic artwork. \\
    69-70 & You win a magic item or an expensive piece of classic artwork. \\
    71-72 & You win a magic item or an expensive piece of classic artwork. \\
    73-74 & You win a magic item or an expensive piece of classic artwork. \\
    75-76 & You win a magic item or an expensive piece of classic artwork. \\
    77-78 & You win a magic item or an expensive piece of classic artwork. \\
    79-80 & You win a magic item or an expensive piece of classic artwork. \\
    81 & You win a magic item or an expensive piece of classic artwork. \\
    82 & You win a magic item or an expensive piece of classic artwork. \\
    83 & You win a magic item or an expensive piece of classic artwork. \\
    84 & You win a magic item or an expensive piece of classic artwork. \\
    85 & You win a magic item or an expensive piece of classic artwork. \\
    86 & You win a magic item or an expensive piece of classic artwork. \\
    87 & You win a magic item or an expensive piece of classic artwork. \\
    88 & You win a magic item or an expensive piece of classic artwork. \\
    89 & You win a magic item or an expensive piece of classic artwork. \\
    90 & You win a magic item or an expensive piece of classic artwork. \\
    91 & You win a magic item or an expensive piece of classic artwork. \\
    92 & You win a magic item or an expensive piece of classic artwork. \\
    93 & You win a magic item or an expensive piece of classic artwork. \\
    94 & You win a magic item or an expensive piece of classic artwork. \\
    95 & You win a magic item or an expensive piece of classic artwork. \\
    96 & You win a magic item or an expensive piece of classic artwork. \\
    97 & You win a magic item or an expensive piece of classic artwork. \\
    98 & You win a magic item or an expensive piece of classic artwork. \\
    99 & You win a magic item or an expensive piece of classic artwork. \\
    100 & You win a magic item or an expensive piece of classic artwork. \\
\end{dndlongtable}

\subsection{Tables with Footnotes}

\begin{minipage}{8cm}
  \begin{DndTable}[header=Footnoted Table]{lX}
    \textbf{Table head\footnote{\enspace Something to note}} & \textbf{Table head} \\
    Some value  & Some value\footnote{\enspace Another thing to note} \\
    Some value  & Some value \\
    Some value  & Some value \\
    Some value\footnote{\enspace The most important note}  & Some value \\
  \end{DndTable}
\end{minipage}

\subsection{Ornamented Tables}
The |ornamentedtabular| allows tables similar to those used for spellcasters
(see over page).

\begin{figure*}[h!]
\begin{ornamentedtabular}{ccp{3.0cm}ccccccccccc}[title={The Full Caster}]
  & & & & & \multicolumn{9}{c}{\thead{--- Spell Slots per Spell Level ---}} \\
  \textbf{Level} & \textbf{\makecell{Proficiency\\Bonus}} & \textbf{Features} & \textbf{\makecell{Cantrips\\Known}} & \textbf{\makecell{Spells\\Known}} & \textbf{1st} & \textbf{2nd} & \textbf{3rd} & \textbf{4th} & \textbf{5th} & \textbf{6th} & \textbf{7th} & \textbf{8th} & \textbf{9th} \\
  1st  & +2 & Feature & 3 & 4  & 2 & — & — & — & — & — & — & — & — \\
  2nd  & +2 & Feature & 3 & 4  & 3 & — & — & — & — & — & — & — & — \\
  3rd  & +2 & Feature & 4 & 4  & 4 & 2 & — & — & — & — & — & — & — \\
  4th  & +2 & Feature & 4 & 5  & 4 & 3 & — & — & — & — & — & — & — \\
  5th  & +3 & Feature & 4 & 6  & 4 & 3 & 2 & — & — & — & — & — & — \\
  6th  & +3 & Feature & 4 & 7  & 4 & 3 & 3 & — & — & — & — & — & — \\
  7th  & +3 & Feature & 4 & 8  & 4 & 3 & 3 & 1 & — & — & — & — & — \\
  8th  & +3 & Feature & 4 & 9  & 4 & 3 & 3 & 2 & — & — & — & — & — \\
  9th  & +4 & Feature & 4 & 10 & 4 & 3 & 3 & 3 & 1 & — & — & — & — \\
  10th & +4 & Feature & 5 & 11 & 4 & 3 & 3 & 3 & 2 & — & — & — & — \\
  11th & +4 & Feature & 5 & 12 & 4 & 3 & 3 & 3 & 2 & 1 & — & — & — \\
  12th & +4 & Feature & 5 & 12 & 4 & 3 & 3 & 3 & 2 & 1 & — & — & — \\
  13th & +4 & Feature & 5 & 13 & 4 & 3 & 3 & 3 & 2 & 1 & 1 & — & — \\
  14th & +5 & Feature & 5 & 13 & 4 & 3 & 3 & 3 & 2 & 1 & 1 & — & — \\
  15th & +5 & Feature & 5 & 14 & 4 & 3 & 3 & 3 & 2 & 1 & 1 & 1 & — \\
  16th & +5 & Feature & 5 & 14 & 4 & 3 & 3 & 3 & 2 & 1 & 1 & 1 & — \\
  17th & +6 & Feature & 5 & 15 & 4 & 3 & 3 & 3 & 2 & 1 & 1 & 1 & 1 \\
  18th & +6 & Feature & 5 & 15 & 4 & 3 & 3 & 3 & 3 & 1 & 1 & 1 & 1 \\
  19th & +6 & Feature & 4 & 15 & 4 & 3 & 3 & 3 & 3 & 2 & 1 & 1 & 1 \\
  20th & +6 & Feature & 5 & 15 & 4 & 3 & 3 & 3 & 3 & 2 & 2 & 1 & 1 \\
\end{ornamentedtabular}
\end{figure*}

\part{Customization}

\chapter{Colors}

\begin{table*}[b]
  \caption{\DndFontTableTitle{}Colors Supported by this Package}\label{tab:colors}

  \begin{tabularx}{\linewidth}{lX}
    \textbf{Color}                  & \textbf{Description} \\
    \rowcolor{PhbLightGreen}
    |PhbLightGreen|                 & Light green used in PHB Part 1 (Default) \\
    \rowcolor{PhbLightCyan}
    |PhbLightCyan|                  & Light cyan used in PHB Part 2 \\
    \rowcolor{PhbMauve}
    |PhbMauve|                      & Pale purple used in PHB Part 3 \\
    \rowcolor{PhbTan}
    |PhbTan|                        & Light brown used in PHB appendix \\
    \rowcolor{DmgLavender}
    |DmgLavender|                   & Pale purple used in DMG Part 1 \\
    \rowcolor{DmgCoral}
    |DmgCoral|                      & Orange-pink used in DMG Part 2 \\
    \rowcolor{DmgSlateGray}
    |DmgSlateGray| (|DmgSlateGrey|) & Blue-gray used in PHB Part 3 \\
    \rowcolor{DmgLilac}
    |DmgLilac|                      & Purple-gray used in DMG appendix \\
    \rowcolor{BrGreen}
    |BrGreen|                       & Gray-green used for tables in Basic Rules\\
  \end{tabularx}
\end{table*}

This package provides several global color variables to style |DndComment|, |DndReadAloud|, |DndSidebar|, and |DndTable| environments.

\begin{DndTable}[header=Box Colors]{lX}
  \textbf{Color}   & \textbf{Description} \\
  |commentcolor|   & |DndComment| background \\
  |readaloudcolor| & |DndReadAloud| background \\
  |sidebarcolor|   & |DndSidebar| background \\
  |tablecolor|     & background of even |DndTable| rows \\
\end{DndTable}

They also accept an optional color argument to set the color for a single instance. See Table~\ref{tab:colors} for a list of core book accent colors.

\begin{lstlisting}
\begin{DndTable}[color=PhbLightCyan]{cX}
  \textbf{d8} & \textbf{Item} \\
  1 & Small wooden button \\
  2 & Red feather \\
  3 & Human tooth \\
  4 & Vial of green liquid \\
  6 & Tasty biscuit \\
  7 & Broken axe handle \\
  8 & Tarnished silver locket \\
\end{DndTable}
\end{lstlisting}

\begin{DndTable}[color=PhbLightCyan]{cX}
  \textbf{d8} & \textbf{Item} \\
  1 & Small wooden button \\
  2 & Red feather \\
  3 & Human tooth \\
  4 & Vial of green liquid \\
  6 & Tasty biscuit \\
  7 & Broken axe handle \\
  8 & Tarnished silver locket \\
\end{DndTable}

\section{Themed Colors}
Use |\DndSetThemeColor[<color>]| to set |commentcolor|, |readaloudcolor|, |sidebarcolor|, and |tablecolor| to a specific color. Calling |\DndSetThemeColor| without an argument sets those colors to the current |themecolor|. In the following example the group limits the change to just a few boxes; after the group finishes, the colors are reverted to what they were before the group started.

\begin{lstlisting}
\begingroup
\DndSetThemeColor[PhbMauve]

\begin{DndComment}{This Comment Is in Mauve}
  This comment is in the the new color.
\end{DndComment}

\begin{DndSidebar}{This Sidebar Is Also Mauve}
  The sidebar is also using the new theme color.
\end{DndSidebar}
\endgroup
\end{lstlisting}

\begingroup
\DndSetThemeColor[PhbMauve]

\begin{DndComment}{This Comment Is in Mauve}
  This comment is in the the new color.
\end{DndComment}

\begin{DndSidebar}{This Sidebar Is Also Mauve}
  The sidebar is also using the new theme color.
\end{DndSidebar}
\endgroup

\end{document}
